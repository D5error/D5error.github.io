# 多重集排列组合
* 排列的元素或者选取的元素可以重复，所以不说$n$个物体，而说$n$**类或$n$种物体**

* 定义：多重集$S={\{n_1\cdot a_1,n_2\cdot a_2,...,n_k\cdot a_k\}}（n=n_1+n_2+...+n_k$表示$S$中元素总数）

## 排列
* 从$S$中有序选取的$r$个元素称为多重集$S$的一个$r$排列。$r=n$称为全排列

* 定理：设$S=\{n1\cdot a1,n2\cdot a2,...,n_k \cdot a_k\}$为多重集
    1. $S$的全排列数是$\frac{n!}{n_1!n_2!...n_k!}$

    2. 若$r<=n_i，i=1,2,...,k$，那么$S$的$r$排列数是$k^r$

    3. 若$r<=n_i，i=1,2,...,k$，那么$S$的$r$组合数是$N=C(k+r-1,r)$

## 组合
* 从$S$中无序选取的$r$个元素称为多重集$S$的一个$r$组合

* 定理：多重集$S=\{n_1\cdot a_1,n_2 \cdot a_2,...,n_k\cdot a_k\}，=<n_i<=+\infty$，当$r<=n_i$，$S$的$r$组合数为$N=C(k+r-1,r)$
    * 证明：一个$r$组合为$\{x_1\cdot a_1,...,x_k\cdot a_k\}$，其中$x_1+x_2+...+x_k=r$，$x_i$为非负整数，这个**不定方程**的**非负整数解**对应于下述排列$r$个1，$k-1$个0的全排列数为$N=\frac{(r+k-1)!}{r!(k-1)!}=C(r+k-1,r)$

        |1...1 |$\color{red}{0}$| 1...1 |$\color{red}{0}$| 1...1 |$\color{red}{0}\color{while}{......}\color{red}{0}$|1...1|
        |-|-|-|-|-|-|-|
        |$x_1$个||$x_2$个||$x_3$个||$x_k$个|

# 二项式定理与组合等式

## 二项式定理
* 组合数$C(n,r)$又称为**二项式系数**，因为出现在二项式的幂的展开式中。二项式的幂$(x+y)^n$的展开式称为**二项式定理**

* 二项式定理：设$x$和$y$是两个变量，$n$是正整数，则：$\Sigma^n_{i=0}(^n_i)x^iy^{n-i}$

## 组合恒等式
* 递推式
    1. $(^n_k)=(^n_{n-k})$：用于化简

    2. $(^n_k)=\frac nk (^{n-1}_{k-1})$：用于求和时消去变系数

    3. $(^n_k)=(^{n-1}_k)+(^{n-1}_{k-1})$：用于求和时拆项（两项之和或两项之差），然后合并

* 基本求和式
    1. $\Sigma ^n_{k=0}(^n_k)=2^n\quad n\in N$

    2. $\Sigma ^n_{k=0}(-1)^k(^n_k)=0\quad n\in N$

* 变系数求和
    1. $\Sigma ^n_{k=0}k(^n_k)=n2^{n-1}$
        * 证明：二项式定理中令$y=1$，$(x+1)^n=(1+x)^n=(^n_0)+(^n_1)x+(^n_2)x^2+...+(^n_{n-1})x^{n-1}+(^n_n)x^n=\Sigma^n_{k=0}(^n_k)x^k=1+\Sigma ^n_{k=1}(^n_k)x^k$

        * 进行微分操作（两端对x求导）：$n(x+1)^{n-1}=\Sigma^n_{k=1}k(^n_k)x^{k-1}$

        * 令$x=1$：$n2^{n-1}=\Sigma ^n_{k=0}k(^n_k)$

    2. $\Sigma ^n_{k=0}k^2(^n_k)=n(n+1)2^{n-2}$
        * 证明：
            $$
            \Sigma ^n_{k=0}k^2(^n_k)\\
            =\Sigma ^n_{k=1}k^2(^n_k)\\
            =\Sigma ^n_{k=1}k^2\frac n k (^{n-1}_{k-1})\\
            =\Sigma ^n_{k=1}kn(^{n-1}_{k-1})\\
            =n\Sigma ^n_{k=1}(k-1+1)(^{n-1}_{k-1})\\
            =n\Sigma^n_{k=1}(k-1)(^{n-1}_{k-1})+n\Sigma ^n_{k=1}(^{n-1}_{k-1})\\
            =n\Sigma ^{n-1}_{k=0}k(^{n-1}_{k})+n\Sigma ^{n-1}_{k=0}(^{n-1}_k)\\
            =n(n-1)2^{n-2}+n2^{n-1}\\
            =n(n+1)2^{n-2}
            $$

* 变上项求和
    1. $\Sigma ^n_{l=0}(^l_k)=(^{n+1}_{k+1})\quad n,k\in N$

        ![Alt text](image-119.png)

* 乘积转换式
    1. $(^n_r)(^r_k)=(^n_k)(^{n-k}_{r-k})$

* 积之和
    1. $\Sigma ^r_{k=0}(^m_k)(^n_{r-k})=(^{m+n}_r)$

        ![Alt text](image-271.png)

    2. $\Sigma ^n_{k=0}(^m_k)(^n_{k})=(^{m+n}_m)$

# 非降路径问题

## 非降路径数
* 设m，n为正整数，从$(0,0)$到$(m,n)$的非降路径数：
    * m步向右，n步向上，共走m+n步

    * 非降路径数：$C(m+n,m)$，即从m+n步中选m步往右，剩下都是往上

* 从$(a,b)$到$(m,n)$的非降路径数：
    * 等于从$(0,0)$到$(m-a,n-b)$的非降路径数$C(m+n-a-b,m-a)$

* 从$(a,b)$经过$(c,d)$到$(m,n)$的非降路径数：
    * 等于从$(a,b)$到$(c,d)$的非降路径数**加上**从$(c,d)$到$(m,n)$的非降路径数

## 限制条件的非降路径数
* 设n为正整数，从$(0,0)$到$(n,n)$除端点外，不接触对角线的非降路径数

1. 先计算对角线下方的不接触非降路径，再乘以2得出结果。**因为对角线上下的不接触非降路径是对称的**

2. 计算从$(0,0)$到$(n,n)$的**对角线下方**不接触非降路径等于从$(0,1)$到$(n,n-1)$的不接触非降路径。**因为从$(0,0)$开始必定经过$(0,1)$且只有一条路，终点也是一样**

3. 计算从$(1,0)$到$(n,n-1)$的全部非降路径等于从$(0,1)$到$(n,n-1)$的**接触非降路径**，最后用全部非降路径减去全部接触非降路径得出全部非接触非降路径。**因为计算从$(0,1)$到$(n,n-1)$的*非接触非降路径*不好计算，故通过全部非降路径减去全部接触非降路径方法计算**；**而全部接触非降路径至少接触一次对角线，也就是计算出至少接触一次对角线的个数，而从对角线上方到对角线下方的路径必然会至少接触一次，所以考虑将$(0,1)$对称到$(1,0)$，计算从$(1,0)$到$(n,n-1)$的全部非降路径就能得出全部接触非降路径**


4. 计算过程：
    1. $(1,0)$到$(n,n-1)$的全部非降路径=$(^{2n-2}_{n-1})$

    2. $(1,0)$到$(n,n-1)$的全部接触非降路径=$(^{2n-2}_{n})$

    3. $(0,0)$到$(n,n)$的对角线下方不接触非降路径=$(^{2n-2}_{n-1})-(^{2n-2}_{n})$

    4. $(0,0)$到$(n,n)$的不接触非降路径=$2[(^{2n-2}_{n-1})-(^{2n-2}_{n})]=\frac2n(^{2n-2}_{n-1})$

## 栈输出的计数
* 将$1,2,...,n$按照顺序输入栈，有多少种不同的输出序列？

* 将进栈总次数记作x，出栈总次数记作y，则不同的输出序列数等于从$(0,0)$到$(n,n)$的**不穿过**对角线的非降路径数

* 计算方法与上面限制条件的非降路径数相似，只不过**不接触**的对角线为$y=x+1$，并且只计算对角线下方不接触非降路径，因为**x>=y**

* $N=(^{2n}_{n})-(^{2n}_{n-1})=\frac{1}{n+1}(^{2n}_{n})$

## 容斥定理
* 不定方程$x_1+x_2+x_3=6$有多少满足$x1<=3,x_2<=2,x_3<=4$的非负整数解
    * 记性质$P_1$为$x_1>=4$，$P_2$为$x_2>=3$，$P_3$为$x_3>=5$
        * 则是求有多少同时不满足$P_1$和$P_2$和$P_3$的解个数

        * 即答案等于非负整数解个数减去满足$P_1$或$P_2$或$P_3$的解个数

    1. 满足$P_1$或$P_2$或$P_3$的解个数：使用容斥定理
        1. 满足$P_1$的解个数：$\Sigma_{i=4}^{6}(^{(6-i)+(2-1)}_{2-1})=3+2+1=6$

        2. 满足$P_2$的解个数：$\Sigma_{i=3}^{6}(^{(6-i)+(2-1)}_{2-1})=4+3+2+1=10$

        3. 满足$P_3$的解个数：$\Sigma_{i=5}^{6}(^{(6-i)+(2-1)}_{2-1})=2+1=3$

        4. 同时满足$P_1$和$P_2$的解个数：$0$

        5. 同时满足$P_1$和$P_3$的解个数：$0$

        6. 同时满足$P_2$和$P_3$的解个数：$0$

        7. 同时满足$P_1$和$P_2$和$P_3$的解个数：$0$

        8. 满足$P_1$或$P_2$或$P_3$的解个数：$6+10+3=19$

    2. 非负整数解个数：$(^{6+(3-1)}_{3-1})=(^8_2)=28$

    3. 答案：$28-19=9$

![Alt text](image-275.png)

![Alt text](image-277.png)
